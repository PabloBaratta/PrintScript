plugins {
    id 'java'
    id 'com.diffplug.spotless' version '6.18.0'
    id 'jacoco-report-aggregation'
}

group = 'org.example'
version = '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    testImplementation platform('org.junit:junit-bom:5.9.1')
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
    jacocoAggregation project(':lexer')
    jacocoAggregation project(':interpreter')
    jacocoAggregation project(':parser')
    jacocoAggregation project(':cli')
    jacocoAggregation project(':ast')
}

tasks.named('testCodeCoverageReport', JacocoReport) {
    doLast {
        def reportLocation = reports.html.outputLocation.get().asFile
        println("HTML report generated: file://${reportLocation.absolutePath}/index.html")
    }
}

tasks.named('check') {
    dependsOn testCodeCoverageReport
}



test {
    useJUnitPlatform()
}

spotless {
    java {
        googleJavaFormat('1.10.0')
        target 'src/**/*.java'
    }
}

